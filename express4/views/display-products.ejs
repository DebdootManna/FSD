<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title><%= title %></title>
    <style>
        :root { color-scheme: light dark; --gap: 12px; --maxw: 1200px; }
        body { margin: 0; font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
        .container { max-width: var(--maxw); margin: 40px auto; padding: 0 16px; }
        h1 { margin: 0 0 24px; font-size: 1.8rem; }
        .header-actions { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 24px; 
        }
        .btn {
            padding: 10px 16px; 
            border: 0; 
            border-radius: 6px; 
            cursor: pointer; 
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }
        .btn-primary {
            background: #2563eb; 
            color: #fff;
        }
        .btn-primary:hover {
            background: #1d4ed8;
        }
        .btn-secondary {
            background: #6b7280; 
            color: #fff;
        }
        .btn-secondary:hover {
            background: #4b5563;
        }
        .btn-danger {
            background: #dc2626; 
            color: #fff;
        }
        .btn-danger:hover {
            background: #b91c1c;
        }
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(127,127,127,.02);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid rgba(127,127,127,.1);
        }
        th {
            background: rgba(127,127,127,.06);
            font-weight: 600;
            font-size: 14px;
            color: #374151;
        }
        td {
            font-size: 14px;
        }
        tr:hover {
            background: rgba(127,127,127,.03);
        }
        .product-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
        }
        .product-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        .product-description {
            color: #6b7280;
            font-size: 13px;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .price {
            font-weight: 600;
            font-size: 16px;
            color: #059669;
        }
        .actions {
            display: flex;
            gap: 8px;
        }
        .no-products {
            text-align: center;
            padding: 40px;
            color: #6b7280;
        }
        .no-products h3 {
            margin-bottom: 8px;
            color: #374151;
        }
        @media (max-width: 768px) {
            .container { padding: 0 12px; }
            table { font-size: 12px; }
            th, td { padding: 8px 12px; }
            .header-actions { flex-direction: column; gap: 16px; align-items: stretch; }
            .actions { flex-direction: column; }
        }
    </style>
</head>
<body>
    <main class="container">
        <div class="header-actions">
            <h1><%= title %></h1>
            <a href="/add-product" class="btn btn-primary">Add New Product</a>
        </div>

        <% if (products && products.length > 0) { %>
            <table>
                <thead>
                    <tr>
                        <th>Image</th>
                        <th>Product Details</th>
                        <th>Price</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% products.forEach(function(product) { %>
                        <tr>
                            <td>
                                <% if (product.imageUrl) { %>
                                    <img src="<%= product.imageUrl %>" alt="<%= product.title %>" class="product-image" onerror="this.style.display='none'">
                                <% } else { %>
                                    <div style="width: 60px; height: 60px; background: #f3f4f6; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #9ca3af; font-size: 12px;">No Image</div>
                                <% } %>
                            </td>
                            <td>
                                <div class="product-title"><%= product.title %></div>
                                <% if (product.description) { %>
                                    <div class="product-description"><%= product.description %></div>
                                <% } %>
                            </td>
                            <td>
                                <span class="price">$<%= product.price ? product.price.toFixed(2) : '0.00' %></span>
                            </td>
                            <td>
                                <div class="actions">
                                    <a href="/edit-product/<%= product._id %>" class="btn btn-secondary btn-sm">Edit</a>
                                    <button onclick="deleteProduct('<%= product._id %>', '<%= product.title %>')" 
                                            class="btn btn-danger btn-sm">Delete</button>
                                </div>
                            </td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        <% } else { %>
            <div class="no-products">
                <h3>No Products Found</h3>
                <p>You haven't added any products yet. Click the "Add New Product" button above to get started.</p>
            </div>
        <% } %>
    </main>

    <script>
        function deleteProduct(productId, productTitle) {
            if (confirm(`Are you sure you want to delete "${productTitle}"?\n\nThis action cannot be undone.`)) {
                window.location.href = '/delete-product/' + productId;
            }
        }
    </script>
</body>
</html>
