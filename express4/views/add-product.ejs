<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title><%= title || (editing ? 'Edit Product' : 'Add Product') %></title>
    <style>
        :root { color-scheme: light dark; --gap: 12px; --maxw: 720px; }
        body { margin: 0; font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }
        .container { max-width: var(--maxw); margin: 40px auto; padding: 0 16px; }
        h1 { margin: 0 0 16px; font-size: 1.6rem; }
        form { display: grid; gap: var(--gap); background: rgba(144, 132, 132, 0.06); padding: 16px; border-radius: 8px; }
        .field { display: grid; gap: 6px; }
        label { font-weight: 600; }
        input[type="text"],
        input[type="url"],
        input[type="number"],
        textarea {
            padding: 10px; border: 1px solid rgba(127,127,127,.4); border-radius: 6px; font: inherit;
        }
        textarea { resize: vertical; min-height: 96px; }
        .actions { display: flex; gap: 12px; justify-content: flex-end; margin-top: 4px; }
        button {
            padding: 10px 16px; border: 0; border-radius: 6px; cursor: pointer; font-weight: 600;
            background: #2563eb; color: #fff;
        }
        .error { color: #dc2626; font-size: .9rem; }
        .muted { color: #6b7280; font-size: .9rem; }
        .nav-link {
            display: inline-block;
            margin-bottom: 16px;
            color: #2563eb;
            text-decoration: none;
            font-weight: 500;
        }
        .nav-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <main class="container">
        <a href="/display-products" class="nav-link">‚Üê Back to Products</a>
        <h1><%= heading || (editing ? 'Edit Product' : 'Add Product') %></h1>

        <% if (errorMessage) { %>
            <div class="error"><%= errorMessage %></div>
        <% } %>

        <form action="<%= formAction || (editing ? '/admin/edit-product' : '/admin/add-product') %>" method="POST" novalidate>
            <input type="hidden" name="_csrf" value="<%= csrfToken || '' %>">
            <input type="hidden" name="id" value="<%= (product && (product.id || product._id)) || '' %>">

            <div class="field">
                <label for="title">Title</label>
                <input
                    id="title"
                    name="title"
                    type="text"
                    required
                    minlength="2"
                    maxlength="120"
                    placeholder="Product title"
                    value="<%= product && product.title ? product.title : '' %>"
                />
            </div>

            <div class="field">
                <label for="imageUrl">Image URL <span class="muted">(optional)</span></label>
                <input
                    id="imageUrl"
                    name="imageUrl"
                    type="url"
                    inputmode="url"
                    placeholder="https://example.com/image.jpg"
                    value="<%= product && product.imageUrl ? product.imageUrl : '' %>"
                />
            </div>

            <div class="field">
                <label for="price">Price</label>
                <input
                    id="price"
                    name="price"
                    type="number"
                    step="0.01"
                    min="0"
                    required
                    placeholder="0.00"
                    value="<%= product && product.price != null ? product.price : '' %>"
                />
            </div>

            <div class="field">
                <label for="description">Description</label>
                <textarea
                    id="description"
                    name="description"
                    rows="4"
                    required
                    minlength="10"
                    maxlength="2000"
                    placeholder="Short product description"
                ><%= product && product.description ? product.description : '' %></textarea>
            </div>

            <div class="actions">
                <button type="submit"><%= editing ? 'Update' : 'Add' %> Product</button>
            </div>
        </form>
    </main>
</body>
</html>